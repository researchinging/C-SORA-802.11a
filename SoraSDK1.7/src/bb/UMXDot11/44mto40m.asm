; Listing generated by Microsoft (R) Optimizing Compiler Version 15.00.30729.207 

include listing.inc

INCLUDELIB OLDNAMES

PUBLIC	??Avcs@@QEBAAEBU_COMPLEX16@@_K@Z		; vcs::operator[]
LinearTableR DD	01H
	DD	073H
	DD	066H
	DD	05aH
	DD	04dH
	DD	040H
	DD	033H
	DD	026H
	DD	01aH
	DD	0dH
	DD	00H
	ORG $+4
LinearTableL DD	00H
	DD	00H
	DD	0dH
	DD	01aH
	DD	026H
	DD	033H
	DD	040H
	DD	04dH
	DD	05aH
	DD	066H
	DD	073H
	ORG $+4
UpLinearTableL DD 017H
	DD	0e9H
	DD	0d1H
	DD	0baH
	DD	0a3H
	DD	08cH
	DD	074H
	DD	05dH
	DD	046H
	DD	02fH
UpLinearTableR DD 017H
	DD	02fH
	DD	046H
	DD	05dH
	DD	074H
	DD	08cH
	DD	0a3H
	DD	0baH
	DD	0d1H
	DD	0e9H
PUBLIC	?GetOutStream@CDown44MTo40M@@QEAAPEAU_COMPLEX16@@H@Z ; CDown44MTo40M::GetOutStream
; Function compile flags: /Ogtpy
; File c:\sorasdk1.7\src\bb\dot11a\dot11\44mto40m.c
;	COMDAT ?GetOutStream@CDown44MTo40M@@QEAAPEAU_COMPLEX16@@H@Z
_TEXT	SEGMENT
this$ = 8
nIQs$ = 16
?GetOutStream@CDown44MTo40M@@QEAAPEAU_COMPLEX16@@H@Z PROC ; CDown44MTo40M::GetOutStream, COMDAT

; 38   :     if (length >= nIQs)

	mov	eax, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+352
	cmp	eax, 56					; 00000038H
	jl	SHORT $LN2@GetOutStre

; 39   :     {
; 40   :         //printf("%d downsampled IQs available\n", nIQs);
; 41   :         start += nIQs;

	add	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+348, 56 ; 00000038H

; 42   :         length -= nIQs;

	sub	eax, 56					; 00000038H
	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+352, eax

; 43   :         return OutStream;

	lea	rax, OFFSET FLAT:?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A ; `FetchDMADataTouchDownSampled44'::`2'::Resampler

; 48   :     }
; 49   : }

	ret	0
$LN2@GetOutStre:

; 44   :     }
; 45   :     else
; 46   :     {
; 47   :         return NULL;

	xor	eax, eax

; 48   :     }
; 49   : }

	ret	0
?GetOutStream@CDown44MTo40M@@QEAAPEAU_COMPLEX16@@H@Z ENDP ; CDown44MTo40M::GetOutStream
_TEXT	ENDS
PUBLIC	?Move@CDown44MTo40M@@AEAAXXZ			; CDown44MTo40M::Move
; Function compile flags: /Ogtpy
;	COMDAT ?Move@CDown44MTo40M@@AEAAXXZ
_TEXT	SEGMENT
this$ = 8
?Move@CDown44MTo40M@@AEAAXXZ PROC			; CDown44MTo40M::Move, COMDAT

; 24   :     if (start > 0)

	mov	eax, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+348
	test	eax, eax
	jle	SHORT $LN4@Move

; 25   :     {
; 26   :         for (int i = 0; i < length; i++)

	xor	ecx, ecx
	xor	edx, edx
	cmp	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+352, ecx
	jle	SHORT $LN11@Move
	lea	r8, OFFSET FLAT:?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A ; `FetchDMADataTouchDownSampled44'::`2'::Resampler
	npad	3
$LL3@Move:

; 27   :         {
; 28   :             OutStream[i] = OutStream[i + start];

	cdqe
	inc	edx
	add	rax, rcx
	inc	rcx
	mov	eax, DWORD PTR [r8+rax*4]
	mov	DWORD PTR [r8+rcx*4-4], eax
	cmp	edx, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+352
	jge	SHORT $LN11@Move

; 25   :     {
; 26   :         for (int i = 0; i < length; i++)

	mov	eax, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+348
	jmp	SHORT $LL3@Move
$LN11@Move:

; 29   :         }
; 30   :         //printf("Move %d IQs from position %d to 0\n", length, start);
; 31   :         start = 0;

	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+348, 0
$LN4@Move:

; 32   :         
; 33   :     }
; 34   : }

	fatret	0
?Move@CDown44MTo40M@@AEAAXXZ ENDP			; CDown44MTo40M::Move
_TEXT	ENDS
PUBLIC	??0CDown44MTo40M@@QEAA@XZ			; CDown44MTo40M::CDown44MTo40M
; Function compile flags: /Ogtpy
;	COMDAT ??0CDown44MTo40M@@QEAA@XZ
_TEXT	SEGMENT
this$ = 8
??0CDown44MTo40M@@QEAA@XZ PROC				; CDown44MTo40M::CDown44MTo40M, COMDAT

; 17   : {

	xor	eax, eax
	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+344, -1
	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+348, eax
	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+352, eax

; 18   :     this->LastIQRight.im = 0;

	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+340, eax

; 19   :     this->LastIQRight.re = 0;

	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+336, eax

; 20   : }

	lea	rax, OFFSET FLAT:?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A ; `FetchDMADataTouchDownSampled44'::`2'::Resampler
	ret	0
??0CDown44MTo40M@@QEAA@XZ ENDP				; CDown44MTo40M::CDown44MTo40M
; Function compile flags: /Ogtpy
; File c:\sorasdk1.7\inc\vector128.h
_TEXT	ENDS
;	COMDAT ??Avcs@@QEBAAEBU_COMPLEX16@@_K@Z
_TEXT	SEGMENT
this$ = 8
index$ = 16
??Avcs@@QEBAAEBU_COMPLEX16@@_K@Z PROC			; vcs::operator[], COMDAT

; 125  : PVECTOR_STRUCT(vcs,  __m128i, COMPLEX16,        16);

	mov	rax, rcx
	ret	0
??Avcs@@QEBAAEBU_COMPLEX16@@_K@Z ENDP			; vcs::operator[]
PUBLIC	?Resample@CDown44MTo40M@@QEAAXAEBUSignalBlock@@@Z ; CDown44MTo40M::Resample
;	COMDAT pdata
; File c:\sorasdk1.7\src\bb\dot11a\dot11\44mto40m.c
pdata	SEGMENT
$pdata$?Resample@CDown44MTo40M@@QEAAXAEBUSignalBlock@@@Z DD imagerel $LN33
	DD	imagerel $LN33+360
	DD	imagerel $unwind$?Resample@CDown44MTo40M@@QEAAXAEBUSignalBlock@@@Z
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$?Resample@CDown44MTo40M@@QEAAXAEBUSignalBlock@@@Z DD 040a01H
	DD	02740aH
	DD	013405H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT ?Resample@CDown44MTo40M@@QEAAXAEBUSignalBlock@@@Z
_TEXT	SEGMENT
this$ = 8
block$ = 16
?Resample@CDown44MTo40M@@QEAAXAEBUSignalBlock@@@Z PROC	; CDown44MTo40M::Resample, COMDAT

; 52   : {

$LN33:
	mov	QWORD PTR [rsp+8], rbx
	mov	QWORD PTR [rsp+16], rdi

; 53   :     const COMPLEX16 *pIQ = &block[0][0];
; 54   :     
; 55   :     int re_left, im_left, j = 0;
; 56   :     int index11;
; 57   :     
; 58   :     Move();

	mov	eax, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+348
	mov	r9d, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+352
	xor	ebx, ebx
	mov	r11, rdx
	lea	rdi, OFFSET FLAT:__ImageBase
	test	eax, eax
	jle	SHORT $LL18@Resample
	mov	edx, ebx
	mov	rcx, rbx
	test	r9d, r9d
	jle	SHORT $LN30@Resample
$LL17@Resample:
	cdqe
	inc	edx
	add	rax, rcx
	inc	rcx
	mov	eax, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A[rdi+rax*4]
	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A[rdi+rcx*4-4], eax
	mov	r9d, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+352
	cmp	edx, r9d
	jge	SHORT $LN30@Resample
	mov	eax, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+348
	jmp	SHORT $LL17@Resample
$LN30@Resample:
	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+348, ebx
	npad	13
$LL18@Resample:

; 59   : 
; 60   :     for (int i = 0; i < SORA_RX_SIGNAL_UNIT_COMPLEX16_NUM * SORA_RX_SIGNAL_UNIT_NUM_PER_DESC; i++)
; 61   :     {
; 62   :         index11 = (LastIQIndex + i + 1) % 11;

	mov	eax, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+344
	lea	r10d, DWORD PTR [rax+rbx+1]
	mov	eax, 780903145				; 2e8ba2e9H
	imul	r10d
	sar	edx, 1
	mov	eax, edx
	shr	eax, 31
	add	edx, eax
	imul	edx, 11
	sub	r10d, edx

; 63   :         
; 64   :         if (index11 > 1)

	cmp	r10d, 1
	jle	SHORT $LN5@Resample

; 65   :         {
; 66   :             //printf(" %d/28 (%d/11) IQ (%d,%d)*%02f coming, ", i, index11, pIQ[i].re, pIQ[i].im, (float)(LinearTableL[index11])/128);
; 67   :             re_left = pIQ[i].re * LinearTableL[index11];
; 68   :             im_left = pIQ[i].im * LinearTableL[index11];
; 69   : 
; 70   :             OutStream[length].re = (LastIQRight.re + re_left) >> MULTIPLE_SHIFT;

	movsx	ecx, WORD PTR [r11]
	movsx	edx, WORD PTR [r11+2]
	movsxd	r8, r10d
	mov	eax, DWORD PTR LinearTableL[rdi+r8*4]
	imul	ecx, eax
	imul	edx, eax
	movsxd	rax, r9d
	add	ecx, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+336
	sar	ecx, 7
	mov	WORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A[rdi+rax*4], cx

; 71   :             OutStream[length].im = (LastIQRight.im + im_left) >> MULTIPLE_SHIFT;

	mov	ecx, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+340
	movsxd	rax, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+352
	add	ecx, edx
	sar	ecx, 7
	mov	WORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A[rdi+rax*4+2], cx

; 72   :             //printf("--> %d: (%d, %d)\n", length, OutStream[length].re, OutStream[length].im);
; 73   :             length++;

	mov	r9d, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+352

; 74   :             LastIQRight.re = pIQ[i].re * LinearTableR[index11];

	mov	ecx, DWORD PTR LinearTableR[rdi+r8*4]
	inc	r9d
	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+352, r9d

; 75   :             LastIQRight.im = pIQ[i].im * LinearTableR[index11];

	jmp	SHORT $LN32@Resample
$LN5@Resample:

; 76   :             //printf(" %d/28 (%d, %d) * %02f + ", i, pIQ[i].re, pIQ[i].im, (float)LinearTableR[index11] / 128);
; 77   :             
; 78   :         }
; 79   :         else if (index11 == 0)

	test	r10d, r10d
	jne	SHORT $LN3@Resample

; 80   :         {
; 81   :             OutStream[length] = pIQ[i];

	mov	eax, DWORD PTR [r11]
	movsxd	rcx, r9d
	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A[rdi+rcx*4], eax

; 82   :             //printf(" prev discarded, %d/28 %d/11 (%d, %d) --> %d: (%d, %d)\n", i, index11, pIQ[i].re, pIQ[i].im, length, OutStream[length].re, OutStream[length].im);
; 83   :             length++;

	mov	r9d, DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+352
	inc	r9d
	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+352, r9d
	jmp	SHORT $LN7@Resample
$LN3@Resample:

; 84   : 
; 85   :         }
; 86   :         else if (index11 == 1)

	cmp	r10d, 1
	jne	SHORT $LN7@Resample

; 87   :         {
; 88   :             LastIQRight.re = pIQ[i].re * LinearTableR[1];

	mov	ecx, DWORD PTR LinearTableR+4
$LN32@Resample:
	movsx	eax, WORD PTR [r11]
	imul	eax, ecx
	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+336, eax

; 89   :             LastIQRight.im = pIQ[i].im * LinearTableR[1];

	movsx	eax, WORD PTR [r11+2]
	imul	eax, ecx
	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+340, eax
$LN7@Resample:
	inc	ebx
	add	r11, 4
	cmp	ebx, 28
	jb	$LL18@Resample

; 90   :             //printf("%d/28 %d/11 (%d, %d)*%02f + ", i, index11, pIQ[i].re, pIQ[i].im, (float)LinearTableR[1] / 128);
; 91   :         }
; 92   :     }
; 93   :     
; 94   :     LastIQIndex = index11;
; 95   : 
; 96   : }

	mov	rbx, QWORD PTR [rsp+8]
	mov	rdi, QWORD PTR [rsp+16]
	mov	DWORD PTR ?Resampler@?1??FetchDMADataTouchDownSampled44@@YAJPEAU__SORA_RADIO_RX_STREAM@@PEADAEAUSignalBlock@@@Z@4VCDown44MTo40M@@A+344, r10d
	ret	0
?Resample@CDown44MTo40M@@QEAAXAEBUSignalBlock@@@Z ENDP	; CDown44MTo40M::Resample
END
